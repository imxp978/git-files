<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Bootstrap demo</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65"
      crossorigin="anonymous"
    />

    <style>
      body {
        background-color: #ffff11;
        font-family: "標楷體", "Arial", sans-serif;
        padding-top: 2%;
      }

      table.border-primary td {
        wi/dth: 50%;
      }
    </style>
  </head>

  <body>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
      crossorigin="anonymous"
    ></script>

    <div class="container">
      <div class="row">
        <table class="table table-bordered border-primary">
          <thead>
            <tr>
              <th colspan="2">
                <img
                  src="雙贏彩.png"
                  alt=""
                  class="mx-auto"
                  style="display: block; max-width: 30%"
                />
              </th>
            </tr>
            <tr>
              <th scope="col">選擇投注號</th>
              <th scope="col">遊戲介紹</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>
                <div
                  id="wrap"
                  style="
                    height: 250px;
                    display: flex;
                    flex-wrap: wrap;
                    align-content: space-around;
                  "
                ></div>
              </td>
              <td>
                基本玩法<br />
                雙贏彩是一種樂透型遊戲，您必須從01~24的號碼中任選12個號碼進行投注。開獎時，開獎單位將隨機開出12個號碼，這一組號碼就是該期雙贏彩的中獎號碼，也稱為「獎號」。您的12個選號如果全部對中當期開出之12個號碼，或者全部未對中，均為中頭獎。
                <table class="table-bordered border-danger">
                  <tr>
                    <td>獎項</td>
                    <td>中獎方式</td>
                  </tr>
                  <tr>
                    <td>頭獎</td>
                    <td>對中當期12個獎號 或 對中當期0個獎號</td>
                  </tr>
                  <tr>
                    <td>二獎</td>
                    <td>對中當期任11個獎號 或 對中任1個獎號</td>
                  </tr>
                  <tr>
                    <td>三獎</td>
                    <td>對中當期任10個獎號 或 對中任2個獎號</td>
                  </tr>
                  <tr>
                    <td>四獎</td>
                    <td>對中當期任9個獎號 或 對中任3個獎號</td>
                  </tr>
                </table>
                <p>頭獎中獎率約1/135萬，總中獎率約1/26</p>
              </td>
            </tr>
            <tr>
              <td>
                <button
                  type="button"
                  class="btn btn-success"
                  onclick="autoChoiceNewfromTeacher()"
                >
                  電腦選號(12號碼)
                </button>
                <button
                  type="button"
                  class="btn btn-primary ms-2"
                  onclick="reset()"
                >
                  清除重選
                </button>
              </td>
              <td>
                獎金分配方式<br />
                雙贏彩所有獎項皆為固定獎項，各獎項金額如下：<br />
                <table class="table-bordered border-info">
                  <thead>
                    <tr>
                      <td>獎項</td>
                      <td>頭獎</td>
                      <td>二獎</td>
                      <td>三獎</td>
                      <td>四獎</td>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>單注獎金</td>
                      <td>$15,000,000</td>
                      <td>$100,000</td>
                      <td>$500</td>
                      <td>$100</td>
                    </tr>
                  </tbody>
                </table>
              </td>
            </tr>
            <tr>
              <td>
                <button
                  type="button"
                  class="btn btn-danger"
                  onclick= openWinner()
                >
                  進行開獎
                </button>
              </td>
              <td id="winner">開獎號碼:
                
              </td>
            </tr>
            <tr>
              <td id="result" colspan="2">開獎狀態</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    <script src="comlib.js"></script>
    <script>

      var prize = {
        0: "頭獎: $15000000",
        1: "二獎: $1000000",
        2: "三獎: $500",
        3: "四獎: $100",
        4: "無中獎",
        5: "無中獎",
        6: "無中獎",
        7: "無中獎",
        8: "無中獎",
        9: "四獎: $100",
        10: "三獎: $500",
        11: "二獎: $100000",
        12: "頭獎: $15000000",
      }


      var importance = {
        normal: "black",
        important: "orange",
        urgent: "red",
      };
      
      const chk_arr = document.getElementsByName('chkRights[]');
      
      function reset () {
        for (let i = 0; i < 24; i++) {
          chk_arr[i].checked = false;
        }
      }

      function autoChoice () {
        reset();
        for(let i = 0; i < 12; i++) {
          let number = rand(0,23);
          if (chk_arr[number].checked === false) {
            chk_arr[number].checked = true;
            console.log(number);
          } else {
            i--;
          }
        }
      }

      function render() {
        const wrap = document.querySelector("#wrap");
        for (let i = 1; i < 25; i++) {
          let j = i;
          j < 10 ? (j = "0" + j) : j;
          
          const div = document.createElement("div");
          div.classList.add("form-check", "form-check=inline");
          
          const input = document.createElement("input");
          input.classList.add("form-check-input");
          input.type = "checkbox";
          input.value = i;
          input.name = "chkRights[]";
          input.id = "Check" + i;
          
          const label = document.createElement("label");
          label.classList.add("form-check-label");
          label.setAttribute("for", "Check" + i);
          label.innerText = j;
          
          wrap.append(div);
          div.append(input, label);
        }
      }
      
      render();

      var picked = [];
      function autoChoiceNew () {
        for(let i = 0; i < 24; i++) {

          if ((chk_arr[i].checked === true) && (!picked.includes(i + 1))) {
            picked.push(i + 1);
          }
        }
        console.log('已勾選的array: '+ picked);

        while(picked.length < 12) {
            let r = rand(1,24);
            while (picked.includes(r)) {
               r = rand(1,24);
            }
            if (chk_arr[r].checked === false)  {
              chk_arr[r].checked = true;
              //console.log('r=' + (r));
              picked.push(r);
            }
            //console.log(picked);
        }
      }

      function autoChoiceNewfromTeacher () {
        var count = 0;
        for(let i = 0; i <= 23; i++) {
          if (chk_arr[i].checked == true) {
            count ++;
          }
        }

        if (count >= 12) {
          alert('more than 12 number');
          return false;
        }

        for (let i = 0; i <= (11-count); i++) {
          let chkData = rand(0,23);
          if (chk_arr[chkData].checked == false) {
            chk_arr[chkData].checked = true;
            picked.push(chkData+1);
          } else {
            i--;
          }
        }
      }


      var selected = [];
      var match = [];

      function openWinner () {
        
        var winnerNumber = "";
        const winner = document.querySelector('#winner');
        const result = document.querySelector('#result');
        for (let i = 0; i < 12; i ++) {
          r = rand(1, 24);
          while(selected.includes(r)) {
            r = rand(1,24);
          }
          selected.push(r);
          winnerNumber += (r+", ");
          //console.log(winnerNumber);
        } 

        //console.log('unsorted: '+selected);
        selected.sort(function(a, b) {
          return a - b; // a - b > 0
        });

        //console.log('sorted: '+selected);
        var selectedSorted = selected;
        //console.log(selectedSorted);

        var winnerNumberSorted = "";
        for (let i = 0; i < selectedSorted.length; i++) { 
          winnerNumberSorted += (selectedSorted[i] + ", ")
        }
        
        let counter = 0;
        let pickedlist = "";
        console.log('selected: ' + selected);
        console.log('picked: ' + picked);
        for (let i = 0; i < 12; i++) {
          if (picked.includes(selected[i])) {
            counter ++;
            match.push(selected[i]);
          }
        }
        console.log('中獎數: '+counter);
        console.log(match);

        for (let i = 0; i < picked.length; i++) {
          pickedlist += (picked[i] + ', ');
        }

        let matchlist = "";

        for (let i = 0; i < match.length; i++) {
          matchlist += (match[i] + ', ');
        }
        
        console.log(prize[match.length]);

        //render
        winner.innerHTML = '開獎號碼: ' + winnerNumber + '<br>排序號碼: ' + winnerNumberSorted;
        result.innerHTML = '投注號碼: ' + pickedlist + '<br>對中獎號: ' + match.length + ' 中獎號碼: ' + matchlist + '<br>中獎狀態: ' + prize[match.length]; 
      }
      



    </script>
  </body>
</html>
